Start to process resolution= 1.0
The number of cpu in your computer is 112
Create the directory:/tmp/tmpvpx8pvqz to save result
use_ae_weights=False, the program will rerun autoencoder
Pretraining the 1th layer...
learning rate = 0.1
Epoch 1/50
 1/12 [=>............................] - ETA: 3:38 - loss: 1.2590 2/12 [====>.........................] - ETA: 0s - loss: 1.1961  12/12 [==============================] - 20s 10ms/step - loss: 1.1508
Epoch 2/50
 1/12 [=>............................] - ETA: 0s - loss: 1.057112/12 [==============================] - 0s 4ms/step - loss: 1.0478
Epoch 3/50
 1/12 [=>............................] - ETA: 0s - loss: 0.961012/12 [==============================] - 0s 3ms/step - loss: 0.9486
Epoch 4/50
 1/12 [=>............................] - ETA: 0s - loss: 0.915112/12 [==============================] - 0s 4ms/step - loss: 0.8620
Epoch 5/50
 1/12 [=>............................] - ETA: 0s - loss: 0.811612/12 [==============================] - 0s 4ms/step - loss: 0.8017
Epoch 6/50
 1/12 [=>............................] - ETA: 0s - loss: 0.781312/12 [==============================] - 0s 4ms/step - loss: 0.7549
Epoch 7/50
 1/12 [=>............................] - ETA: 0s - loss: 0.735912/12 [==============================] - 0s 4ms/step - loss: 0.7190
Epoch 8/50
 1/12 [=>............................] - ETA: 0s - loss: 0.686612/12 [==============================] - 0s 4ms/step - loss: 0.6925
Epoch 9/50
 1/12 [=>............................] - ETA: 0s - loss: 0.655412/12 [==============================] - 0s 4ms/step - loss: 0.6716
Epoch 10/50
 1/12 [=>............................] - ETA: 0s - loss: 0.672012/12 [==============================] - 0s 4ms/step - loss: 0.6550
Epoch 11/50
 1/12 [=>............................] - ETA: 0s - loss: 0.673612/12 [==============================] - 0s 4ms/step - loss: 0.6400
Epoch 12/50
 1/12 [=>............................] - ETA: 0s - loss: 0.624812/12 [==============================] - 0s 4ms/step - loss: 0.6282
Epoch 13/50
 1/12 [=>............................] - ETA: 0s - loss: 0.616612/12 [==============================] - 0s 4ms/step - loss: 0.6163
Epoch 14/50
 1/12 [=>............................] - ETA: 0s - loss: 0.616612/12 [==============================] - 0s 4ms/step - loss: 0.6071
Epoch 15/50
 1/12 [=>............................] - ETA: 0s - loss: 0.599012/12 [==============================] - 0s 4ms/step - loss: 0.5978
Epoch 16/50
 1/12 [=>............................] - ETA: 0s - loss: 0.603912/12 [==============================] - 0s 4ms/step - loss: 0.5889
Epoch 17/50
 1/12 [=>............................] - ETA: 0s - loss: 0.574312/12 [==============================] - 0s 5ms/step - loss: 0.5819
Epoch 18/50
 1/12 [=>............................] - ETA: 0s - loss: 0.594912/12 [==============================] - 0s 4ms/step - loss: 0.5741
Epoch 19/50
 1/12 [=>............................] - ETA: 0s - loss: 0.569412/12 [==============================] - 0s 4ms/step - loss: 0.5679
Epoch 20/50
 1/12 [=>............................] - ETA: 0s - loss: 0.588312/12 [==============================] - 0s 4ms/step - loss: 0.5612
Epoch 21/50
 1/12 [=>............................] - ETA: 0s - loss: 0.566312/12 [==============================] - 0s 4ms/step - loss: 0.5552
Epoch 22/50
 1/12 [=>............................] - ETA: 0s - loss: 0.562012/12 [==============================] - 0s 4ms/step - loss: 0.5501
Epoch 23/50
 1/12 [=>............................] - ETA: 0s - loss: 0.541712/12 [==============================] - 0s 4ms/step - loss: 0.5449
Epoch 24/50
 1/12 [=>............................] - ETA: 0s - loss: 0.528612/12 [==============================] - 0s 4ms/step - loss: 0.5397
Epoch 25/50
 1/12 [=>............................] - ETA: 0s - loss: 0.539512/12 [==============================] - 0s 4ms/step - loss: 0.5353
Epoch 26/50
 1/12 [=>............................] - ETA: 0s - loss: 0.547612/12 [==============================] - 0s 4ms/step - loss: 0.5304
Epoch 27/50
 1/12 [=>............................] - ETA: 0s - loss: 0.518012/12 [==============================] - 0s 4ms/step - loss: 0.5261
Epoch 28/50
 1/12 [=>............................] - ETA: 0s - loss: 0.536612/12 [==============================] - 0s 4ms/step - loss: 0.5224
Epoch 29/50
 1/12 [=>............................] - ETA: 0s - loss: 0.527912/12 [==============================] - 0s 4ms/step - loss: 0.5195
Epoch 30/50
 1/12 [=>............................] - ETA: 0s - loss: 0.497412/12 [==============================] - 0s 4ms/step - loss: 0.5154
Epoch 31/50
 1/12 [=>............................] - ETA: 0s - loss: 0.520812/12 [==============================] - 0s 4ms/step - loss: 0.5120
Epoch 32/50
 1/12 [=>............................] - ETA: 0s - loss: 0.509412/12 [==============================] - 0s 4ms/step - loss: 0.5079
Epoch 33/50
 1/12 [=>............................] - ETA: 0s - loss: 0.518012/12 [==============================] - 0s 4ms/step - loss: 0.5052
Epoch 34/50
 1/12 [=>............................] - ETA: 0s - loss: 0.511512/12 [==============================] - 0s 4ms/step - loss: 0.5020
Epoch 35/50
 1/12 [=>............................] - ETA: 0s - loss: 0.510112/12 [==============================] - 0s 4ms/step - loss: 0.4990
Epoch 36/50
 1/12 [=>............................] - ETA: 0s - loss: 0.501112/12 [==============================] - 0s 4ms/step - loss: 0.4962
Epoch 37/50
 1/12 [=>............................] - ETA: 0s - loss: 0.483412/12 [==============================] - 0s 4ms/step - loss: 0.4934
Epoch 38/50
 1/12 [=>............................] - ETA: 0s - loss: 0.497112/12 [==============================] - 0s 4ms/step - loss: 0.4911
Epoch 39/50
 1/12 [=>............................] - ETA: 0s - loss: 0.487712/12 [==============================] - 0s 4ms/step - loss: 0.4887
Epoch 40/50
 1/12 [=>............................] - ETA: 0s - loss: 0.483612/12 [==============================] - 0s 4ms/step - loss: 0.4857
Epoch 41/50
 1/12 [=>............................] - ETA: 0s - loss: 0.481712/12 [==============================] - 0s 5ms/step - loss: 0.4840
Epoch 42/50
 1/12 [=>............................] - ETA: 0s - loss: 0.484912/12 [==============================] - 0s 4ms/step - loss: 0.4814
Epoch 43/50
 1/12 [=>............................] - ETA: 0s - loss: 0.497012/12 [==============================] - 0s 4ms/step - loss: 0.4786
Epoch 44/50
 1/12 [=>............................] - ETA: 0s - loss: 0.467712/12 [==============================] - 0s 4ms/step - loss: 0.4775
Epoch 45/50
 1/12 [=>............................] - ETA: 0s - loss: 0.478512/12 [==============================] - 0s 4ms/step - loss: 0.4750
Epoch 46/50
 1/12 [=>............................] - ETA: 0s - loss: 0.466112/12 [==============================] - 0s 4ms/step - loss: 0.4734
Epoch 47/50
 1/12 [=>............................] - ETA: 0s - loss: 0.455012/12 [==============================] - ETA: 0s - loss: 0.471112/12 [==============================] - 0s 5ms/step - loss: 0.4711
Epoch 48/50
 1/12 [=>............................] - ETA: 0s - loss: 0.485612/12 [==============================] - 0s 4ms/step - loss: 0.4691
Epoch 49/50
 1/12 [=>............................] - ETA: 0s - loss: 0.470712/12 [==============================] - 0s 4ms/step - loss: 0.4673
Epoch 50/50
 1/12 [=>............................] - ETA: 0s - loss: 0.464112/12 [==============================] - 0s 4ms/step - loss: 0.4654
learning rate = 0.01
Epoch 1/50
 1/12 [=>............................] - ETA: 3s - loss: 0.487012/12 [==============================] - 0s 4ms/step - loss: 0.4642
Epoch 2/50
 1/12 [=>............................] - ETA: 0s - loss: 0.450712/12 [==============================] - ETA: 0s - loss: 0.464312/12 [==============================] - 0s 5ms/step - loss: 0.4643
Epoch 3/50
 1/12 [=>............................] - ETA: 0s - loss: 0.450212/12 [==============================] - 0s 4ms/step - loss: 0.4645
Epoch 4/50
 1/12 [=>............................] - ETA: 0s - loss: 0.474112/12 [==============================] - 0s 4ms/step - loss: 0.4647
Epoch 5/50
 1/12 [=>............................] - ETA: 0s - loss: 0.453112/12 [==============================] - 0s 4ms/step - loss: 0.4642
Epoch 6/50
 1/12 [=>............................] - ETA: 0s - loss: 0.468412/12 [==============================] - 0s 4ms/step - loss: 0.4639
Epoch 7/50
 1/12 [=>............................] - ETA: 0s - loss: 0.466812/12 [==============================] - 0s 4ms/step - loss: 0.4640
Epoch 8/50
 1/12 [=>............................] - ETA: 0s - loss: 0.448112/12 [==============================] - 0s 4ms/step - loss: 0.4636
Epoch 9/50
 1/12 [=>............................] - ETA: 0s - loss: 0.443212/12 [==============================] - 0s 4ms/step - loss: 0.4634
Epoch 10/50
 1/12 [=>............................] - ETA: 0s - loss: 0.468412/12 [==============================] - 0s 4ms/step - loss: 0.4632
Epoch 11/50
 1/12 [=>............................] - ETA: 0s - loss: 0.487212/12 [==============================] - ETA: 0s - loss: 0.463212/12 [==============================] - 0s 5ms/step - loss: 0.4632
Epoch 12/50
 1/12 [=>............................] - ETA: 0s - loss: 0.456612/12 [==============================] - 0s 4ms/step - loss: 0.4630
Epoch 13/50
 1/12 [=>............................] - ETA: 0s - loss: 0.460912/12 [==============================] - 0s 4ms/step - loss: 0.4625
Epoch 14/50
 1/12 [=>............................] - ETA: 0s - loss: 0.466112/12 [==============================] - 0s 4ms/step - loss: 0.4625
Epoch 15/50
 1/12 [=>............................] - ETA: 0s - loss: 0.460512/12 [==============================] - 0s 4ms/step - loss: 0.4619
Epoch 16/50
 1/12 [=>............................] - ETA: 0s - loss: 0.471212/12 [==============================] - 0s 4ms/step - loss: 0.4622
Epoch 17/50
 1/12 [=>............................] - ETA: 0s - loss: 0.451112/12 [==============================] - 0s 4ms/step - loss: 0.4614
Epoch 18/50
 1/12 [=>............................] - ETA: 0s - loss: 0.474112/12 [==============================] - 0s 4ms/step - loss: 0.4625
Epoch 19/50
 1/12 [=>............................] - ETA: 0s - loss: 0.458312/12 [==============================] - 0s 4ms/step - loss: 0.4618
Epoch 20/50
 1/12 [=>............................] - ETA: 0s - loss: 0.482312/12 [==============================] - 0s 4ms/step - loss: 0.4621
Epoch 21/50
 1/12 [=>............................] - ETA: 0s - loss: 0.465712/12 [==============================] - 0s 4ms/step - loss: 0.4613
Epoch 22/50
 1/12 [=>............................] - ETA: 0s - loss: 0.468912/12 [==============================] - 0s 4ms/step - loss: 0.4609
Epoch 23/50
 1/12 [=>............................] - ETA: 0s - loss: 0.455812/12 [==============================] - 0s 4ms/step - loss: 0.4610
Epoch 24/50
 1/12 [=>............................] - ETA: 0s - loss: 0.448512/12 [==============================] - 0s 4ms/step - loss: 0.4607
Epoch 25/50
 1/12 [=>............................] - ETA: 0s - loss: 0.461912/12 [==============================] - ETA: 0s - loss: 0.460812/12 [==============================] - 0s 5ms/step - loss: 0.4608
Epoch 26/50
 1/12 [=>............................] - ETA: 0s - loss: 0.475012/12 [==============================] - 0s 4ms/step - loss: 0.4608
Epoch 27/50
 1/12 [=>............................] - ETA: 0s - loss: 0.451812/12 [==============================] - 0s 4ms/step - loss: 0.4609
Epoch 28/50
 1/12 [=>............................] - ETA: 0s - loss: 0.471412/12 [==============================] - 0s 4ms/step - loss: 0.4595
Epoch 29/50
 1/12 [=>............................] - ETA: 0s - loss: 0.463912/12 [==============================] - 0s 4ms/step - loss: 0.4599
Epoch 30/50
 1/12 [=>............................] - ETA: 0s - loss: 0.442812/12 [==============================] - 0s 4ms/step - loss: 0.4600
Epoch 31/50
 1/12 [=>............................] - ETA: 0s - loss: 0.467912/12 [==============================] - 0s 4ms/step - loss: 0.4597
Epoch 32/50
 1/12 [=>............................] - ETA: 0s - loss: 0.457512/12 [==============================] - 0s 4ms/step - loss: 0.4591
Epoch 33/50
 1/12 [=>............................] - ETA: 0s - loss: 0.469512/12 [==============================] - 0s 4ms/step - loss: 0.4595
Epoch 34/50
 1/12 [=>............................] - ETA: 0s - loss: 0.468712/12 [==============================] - 0s 4ms/step - loss: 0.4594
Epoch 35/50
 1/12 [=>............................] - ETA: 0s - loss: 0.469212/12 [==============================] - 0s 4ms/step - loss: 0.4595
Epoch 36/50
 1/12 [=>............................] - ETA: 0s - loss: 0.464912/12 [==============================] - 0s 4ms/step - loss: 0.4590
Epoch 37/50
 1/12 [=>............................] - ETA: 0s - loss: 0.447312/12 [==============================] - 0s 4ms/step - loss: 0.4588
Epoch 38/50
 1/12 [=>............................] - ETA: 0s - loss: 0.462012/12 [==============================] - 0s 4ms/step - loss: 0.4587
Epoch 39/50
 1/12 [=>............................] - ETA: 0s - loss: 0.456212/12 [==============================] - 0s 4ms/step - loss: 0.4584
Epoch 40/50
 1/12 [=>............................] - ETA: 0s - loss: 0.454512/12 [==============================] - ETA: 0s - loss: 0.458412/12 [==============================] - 0s 5ms/step - loss: 0.4584
Epoch 41/50
 1/12 [=>............................] - ETA: 0s - loss: 0.456412/12 [==============================] - 0s 4ms/step - loss: 0.4587
Epoch 42/50
 1/12 [=>............................] - ETA: 0s - loss: 0.460612/12 [==============================] - 0s 4ms/step - loss: 0.4584
Epoch 43/50
 1/12 [=>............................] - ETA: 0s - loss: 0.474512/12 [==============================] - 0s 4ms/step - loss: 0.4581
Epoch 44/50
 1/12 [=>............................] - ETA: 0s - loss: 0.447312/12 [==============================] - 0s 4ms/step - loss: 0.4579
Epoch 45/50
 1/12 [=>............................] - ETA: 0s - loss: 0.460712/12 [==============================] - 0s 4ms/step - loss: 0.4573
Epoch 46/50
 1/12 [=>............................] - ETA: 0s - loss: 0.452012/12 [==============================] - 0s 4ms/step - loss: 0.4576
Epoch 47/50
 1/12 [=>............................] - ETA: 0s - loss: 0.440412/12 [==============================] - 0s 4ms/step - loss: 0.4574
Epoch 48/50
 1/12 [=>............................] - ETA: 0s - loss: 0.473012/12 [==============================] - 0s 4ms/step - loss: 0.4575
Epoch 49/50
 1/12 [=>............................] - ETA: 0s - loss: 0.462012/12 [==============================] - 0s 4ms/step - loss: 0.4570
Epoch 50/50
 1/12 [=>............................] - ETA: 0s - loss: 0.456612/12 [==============================] - 0s 4ms/step - loss: 0.4564
learning rate = 0.001
Epoch 1/50
 1/12 [=>............................] - ETA: 3s - loss: 0.480212/12 [==============================] - 0s 4ms/step - loss: 0.4569
Epoch 2/50
 1/12 [=>............................] - ETA: 0s - loss: 0.445612/12 [==============================] - 0s 4ms/step - loss: 0.4570
Epoch 3/50
 1/12 [=>............................] - ETA: 0s - loss: 0.442912/12 [==============================] - 0s 4ms/step - loss: 0.4568
Epoch 4/50
 1/12 [=>............................] - ETA: 0s - loss: 0.465612/12 [==============================] - ETA: 0s - loss: 0.457012/12 [==============================] - 0s 5ms/step - loss: 0.4570
Epoch 5/50
 1/12 [=>............................] - ETA: 0s - loss: 0.445612/12 [==============================] - 0s 4ms/step - loss: 0.4563
Epoch 6/50
 1/12 [=>............................] - ETA: 0s - loss: 0.463312/12 [==============================] - 0s 4ms/step - loss: 0.4567
Epoch 7/50
 1/12 [=>............................] - ETA: 0s - loss: 0.457112/12 [==============================] - 0s 4ms/step - loss: 0.4570
Epoch 8/50
 1/12 [=>............................] - ETA: 0s - loss: 0.442012/12 [==============================] - 0s 5ms/step - loss: 0.4567
Epoch 9/50
 1/12 [=>............................] - ETA: 0s - loss: 0.436211/12 [==========================>...] - ETA: 0s - loss: 0.457012/12 [==============================] - 0s 5ms/step - loss: 0.4569
Epoch 10/50
 1/12 [=>............................] - ETA: 0s - loss: 0.463712/12 [==============================] - 0s 4ms/step - loss: 0.4564
Epoch 11/50
 1/12 [=>............................] - ETA: 0s - loss: 0.479712/12 [==============================] - 0s 4ms/step - loss: 0.4563
Epoch 12/50
 1/12 [=>............................] - ETA: 0s - loss: 0.449912/12 [==============================] - 0s 4ms/step - loss: 0.4566
Epoch 13/50
 1/12 [=>............................] - ETA: 0s - loss: 0.454812/12 [==============================] - 0s 4ms/step - loss: 0.4568
Epoch 14/50
 1/12 [=>............................] - ETA: 0s - loss: 0.459612/12 [==============================] - 0s 4ms/step - loss: 0.4558
Epoch 15/50
 1/12 [=>............................] - ETA: 0s - loss: 0.453312/12 [==============================] - 0s 4ms/step - loss: 0.4571
Epoch 16/50
 1/12 [=>............................] - ETA: 0s - loss: 0.467212/12 [==============================] - 0s 4ms/step - loss: 0.4570
Epoch 17/50
 1/12 [=>............................] - ETA: 0s - loss: 0.445812/12 [==============================] - 0s 4ms/step - loss: 0.4567
Epoch 18/50
 1/12 [=>............................] - ETA: 0s - loss: 0.470312/12 [==============================] - 0s 4ms/step - loss: 0.4567
Epoch 19/50
 1/12 [=>............................] - ETA: 0s - loss: 0.456312/12 [==============================] - 0s 4ms/step - loss: 0.4569
Epoch 20/50
 1/12 [=>............................] - ETA: 0s - loss: 0.476712/12 [==============================] - 0s 4ms/step - loss: 0.4570
Epoch 21/50
 1/12 [=>............................] - ETA: 0s - loss: 0.459212/12 [==============================] - 0s 4ms/step - loss: 0.4567
Epoch 22/50
 1/12 [=>............................] - ETA: 0s - loss: 0.462612/12 [==============================] - 0s 4ms/step - loss: 0.4564
Epoch 23/50
 1/12 [=>............................] - ETA: 0s - loss: 0.448112/12 [==============================] - 0s 4ms/step - loss: 0.4567
Epoch 24/50
 1/12 [=>............................] - ETA: 0s - loss: 0.442412/12 [==============================] - 0s 4ms/step - loss: 0.4563
Epoch 24: early stopping
The 1th layer has been pretrained.
  1/372 [..............................] - ETA: 20s 69/372 [====>.........................] - ETA: 0s 137/372 [==========>...................] - ETA: 0s204/372 [===============>..............] - ETA: 0s273/372 [=====================>........] - ETA: 0s341/372 [==========================>...] - ETA: 0s372/372 [==============================] - 0s 738us/step
Pretraining the 2th layer...
learning rate = 0.1
Epoch 1/50
 1/12 [=>............................] - ETA: 4s - loss: 3.220112/12 [==============================] - 0s 3ms/step - loss: 2.8195
Epoch 2/50
 1/12 [=>............................] - ETA: 0s - loss: 2.537012/12 [==============================] - 0s 2ms/step - loss: 2.4948
Epoch 3/50
 1/12 [=>............................] - ETA: 0s - loss: 2.183612/12 [==============================] - 0s 2ms/step - loss: 2.1082
Epoch 4/50
 1/12 [=>............................] - ETA: 0s - loss: 2.011012/12 [==============================] - 0s 2ms/step - loss: 1.8277
Epoch 5/50
 1/12 [=>............................] - ETA: 0s - loss: 1.662712/12 [==============================] - 0s 2ms/step - loss: 1.6373
Epoch 6/50
 1/12 [=>............................] - ETA: 0s - loss: 1.550312/12 [==============================] - 0s 2ms/step - loss: 1.5100
Epoch 7/50
 1/12 [=>............................] - ETA: 0s - loss: 1.483612/12 [==============================] - 0s 2ms/step - loss: 1.4150
Epoch 8/50
 1/12 [=>............................] - ETA: 0s - loss: 1.310512/12 [==============================] - 0s 2ms/step - loss: 1.3315
Epoch 9/50
 1/12 [=>............................] - ETA: 0s - loss: 1.228512/12 [==============================] - 0s 2ms/step - loss: 1.2734
Epoch 10/50
 1/12 [=>............................] - ETA: 0s - loss: 1.283912/12 [==============================] - 0s 2ms/step - loss: 1.2268
Epoch 11/50
 1/12 [=>............................] - ETA: 0s - loss: 1.294412/12 [==============================] - 0s 2ms/step - loss: 1.1804
Epoch 12/50
 1/12 [=>............................] - ETA: 0s - loss: 1.120412/12 [==============================] - 0s 2ms/step - loss: 1.1426
Epoch 13/50
 1/12 [=>............................] - ETA: 0s - loss: 1.137012/12 [==============================] - 0s 2ms/step - loss: 1.1137
Epoch 14/50
 1/12 [=>............................] - ETA: 0s - loss: 1.114412/12 [==============================] - 0s 2ms/step - loss: 1.0812
Epoch 15/50
 1/12 [=>............................] - ETA: 0s - loss: 1.076912/12 [==============================] - 0s 2ms/step - loss: 1.0618
Epoch 16/50
 1/12 [=>............................] - ETA: 0s - loss: 1.074812/12 [==============================] - 0s 2ms/step - loss: 1.0352
Epoch 17/50
 1/12 [=>............................] - ETA: 0s - loss: 0.990112/12 [==============================] - 0s 2ms/step - loss: 1.0154
Epoch 18/50
 1/12 [=>............................] - ETA: 0s - loss: 1.047412/12 [==============================] - 0s 2ms/step - loss: 0.9989
Epoch 19/50
 1/12 [=>............................] - ETA: 0s - loss: 0.977812/12 [==============================] - 0s 2ms/step - loss: 0.9803
Epoch 20/50
 1/12 [=>............................] - ETA: 0s - loss: 1.026812/12 [==============================] - 0s 2ms/step - loss: 0.9634
Epoch 21/50
 1/12 [=>............................] - ETA: 0s - loss: 0.998412/12 [==============================] - 0s 2ms/step - loss: 0.9475
Epoch 22/50
 1/12 [=>............................] - ETA: 0s - loss: 0.950912/12 [==============================] - 0s 2ms/step - loss: 0.9349
Epoch 23/50
 1/12 [=>............................] - ETA: 0s - loss: 0.909612/12 [==============================] - 0s 2ms/step - loss: 0.9247
Epoch 24/50
 1/12 [=>............................] - ETA: 0s - loss: 0.862312/12 [==============================] - 0s 2ms/step - loss: 0.9111
Epoch 25/50
 1/12 [=>............................] - ETA: 0s - loss: 0.907512/12 [==============================] - 0s 2ms/step - loss: 0.8989
Epoch 26/50
 1/12 [=>............................] - ETA: 0s - loss: 0.927512/12 [==============================] - 0s 2ms/step - loss: 0.8876
Epoch 27/50
 1/12 [=>............................] - ETA: 0s - loss: 0.842212/12 [==============================] - 0s 2ms/step - loss: 0.8764
Epoch 28/50
 1/12 [=>............................] - ETA: 0s - loss: 0.888612/12 [==============================] - 0s 2ms/step - loss: 0.8687
Epoch 29/50
 1/12 [=>............................] - ETA: 0s - loss: 0.856512/12 [==============================] - 0s 2ms/step - loss: 0.8534
Epoch 30/50
 1/12 [=>............................] - ETA: 0s - loss: 0.796212/12 [==============================] - 0s 2ms/step - loss: 0.8464
Epoch 31/50
 1/12 [=>............................] - ETA: 0s - loss: 0.851312/12 [==============================] - 0s 2ms/step - loss: 0.8338
Epoch 32/50
 1/12 [=>............................] - ETA: 0s - loss: 0.856012/12 [==============================] - 0s 2ms/step - loss: 0.8298
Epoch 33/50
 1/12 [=>............................] - ETA: 0s - loss: 0.848212/12 [==============================] - 0s 2ms/step - loss: 0.8181
Epoch 34/50
 1/12 [=>............................] - ETA: 0s - loss: 0.816012/12 [==============================] - 0s 2ms/step - loss: 0.8083
Epoch 35/50
 1/12 [=>............................] - ETA: 0s - loss: 0.806212/12 [==============================] - 0s 2ms/step - loss: 0.7973
Epoch 36/50
 1/12 [=>............................] - ETA: 0s - loss: 0.799712/12 [==============================] - 0s 2ms/step - loss: 0.7958
Epoch 37/50
 1/12 [=>............................] - ETA: 0s - loss: 0.764712/12 [==============================] - 0s 2ms/step - loss: 0.7792
Epoch 38/50
 1/12 [=>............................] - ETA: 0s - loss: 0.799412/12 [==============================] - 0s 2ms/step - loss: 0.7728
Epoch 39/50
 1/12 [=>............................] - ETA: 0s - loss: 0.773012/12 [==============================] - 0s 2ms/step - loss: 0.7710
Epoch 40/50
 1/12 [=>............................] - ETA: 0s - loss: 0.763112/12 [==============================] - 0s 2ms/step - loss: 0.7666
Epoch 41/50
 1/12 [=>............................] - ETA: 0s - loss: 0.744212/12 [==============================] - 0s 2ms/step - loss: 0.7584
Epoch 42/50
 1/12 [=>............................] - ETA: 0s - loss: 0.772012/12 [==============================] - 0s 2ms/step - loss: 0.7535
Epoch 43/50
 1/12 [=>............................] - ETA: 0s - loss: 0.784212/12 [==============================] - 0s 2ms/step - loss: 0.7448
Epoch 44/50
 1/12 [=>............................] - ETA: 0s - loss: 0.714812/12 [==============================] - 0s 2ms/step - loss: 0.7374
Epoch 45/50
 1/12 [=>............................] - ETA: 0s - loss: 0.746612/12 [==============================] - 0s 2ms/step - loss: 0.7369
Epoch 46/50
 1/12 [=>............................] - ETA: 0s - loss: 0.712812/12 [==============================] - 0s 2ms/step - loss: 0.7311
Epoch 47/50
 1/12 [=>............................] - ETA: 0s - loss: 0.675112/12 [==============================] - 0s 2ms/step - loss: 0.7209
Epoch 48/50
 1/12 [=>............................] - ETA: 0s - loss: 0.739212/12 [==============================] - 0s 2ms/step - loss: 0.7209
Epoch 49/50
 1/12 [=>............................] - ETA: 0s - loss: 0.726312/12 [==============================] - 0s 2ms/step - loss: 0.7191
Epoch 50/50
 1/12 [=>............................] - ETA: 0s - loss: 0.723312/12 [==============================] - 0s 2ms/step - loss: 0.7162
learning rate = 0.01
Epoch 1/50
 1/12 [=>............................] - ETA: 3s - loss: 0.783312/12 [==============================] - 0s 2ms/step - loss: 0.7078
Epoch 2/50
 1/12 [=>............................] - ETA: 0s - loss: 0.672212/12 [==============================] - 0s 2ms/step - loss: 0.7060
Epoch 3/50
 1/12 [=>............................] - ETA: 0s - loss: 0.668312/12 [==============================] - 0s 2ms/step - loss: 0.7016
Epoch 4/50
 1/12 [=>............................] - ETA: 0s - loss: 0.717512/12 [==============================] - 0s 2ms/step - loss: 0.7018
Epoch 5/50
 1/12 [=>............................] - ETA: 0s - loss: 0.694512/12 [==============================] - 0s 2ms/step - loss: 0.7011
Epoch 6/50
 1/12 [=>............................] - ETA: 0s - loss: 0.694912/12 [==============================] - 0s 2ms/step - loss: 0.6994
Epoch 7/50
 1/12 [=>............................] - ETA: 0s - loss: 0.712712/12 [==============================] - 0s 2ms/step - loss: 0.6996
Epoch 8/50
 1/12 [=>............................] - ETA: 0s - loss: 0.670512/12 [==============================] - 0s 2ms/step - loss: 0.6987
Epoch 9/50
 1/12 [=>............................] - ETA: 0s - loss: 0.664212/12 [==============================] - 0s 2ms/step - loss: 0.6989
Epoch 10/50
 1/12 [=>............................] - ETA: 0s - loss: 0.711812/12 [==============================] - 0s 2ms/step - loss: 0.6970
Epoch 11/50
 1/12 [=>............................] - ETA: 0s - loss: 0.732612/12 [==============================] - 0s 2ms/step - loss: 0.6945
Epoch 12/50
 1/12 [=>............................] - ETA: 0s - loss: 0.683712/12 [==============================] - 0s 2ms/step - loss: 0.6981
Epoch 13/50
 1/12 [=>............................] - ETA: 0s - loss: 0.696912/12 [==============================] - 0s 2ms/step - loss: 0.6959
Epoch 14/50
 1/12 [=>............................] - ETA: 0s - loss: 0.726412/12 [==============================] - 0s 2ms/step - loss: 0.6998
Epoch 15/50
 1/12 [=>............................] - ETA: 0s - loss: 0.701512/12 [==============================] - 0s 2ms/step - loss: 0.7000
Epoch 16/50
 1/12 [=>............................] - ETA: 0s - loss: 0.710712/12 [==============================] - 0s 2ms/step - loss: 0.6926
Epoch 17/50
 1/12 [=>............................] - ETA: 0s - loss: 0.676812/12 [==============================] - 0s 2ms/step - loss: 0.6941
Epoch 18/50
 1/12 [=>............................] - ETA: 0s - loss: 0.728012/12 [==============================] - 0s 2ms/step - loss: 0.6947
Epoch 19/50
 1/12 [=>............................] - ETA: 0s - loss: 0.696912/12 [==============================] - 0s 2ms/step - loss: 0.6961
Epoch 20/50
 1/12 [=>............................] - ETA: 0s - loss: 0.715712/12 [==============================] - 0s 2ms/step - loss: 0.6930
Epoch 21/50
 1/12 [=>............................] - ETA: 0s - loss: 0.722812/12 [==============================] - 0s 2ms/step - loss: 0.6925
Epoch 22/50
 1/12 [=>............................] - ETA: 0s - loss: 0.692812/12 [==============================] - 0s 2ms/step - loss: 0.6911
Epoch 23/50
 1/12 [=>............................] - ETA: 0s - loss: 0.680912/12 [==============================] - 0s 2ms/step - loss: 0.6930
Epoch 24/50
 1/12 [=>............................] - ETA: 0s - loss: 0.653712/12 [==============================] - 0s 2ms/step - loss: 0.6929
Epoch 25/50
 1/12 [=>............................] - ETA: 0s - loss: 0.689812/12 [==============================] - 0s 2ms/step - loss: 0.6917
Epoch 26/50
 1/12 [=>............................] - ETA: 0s - loss: 0.714312/12 [==============================] - 0s 2ms/step - loss: 0.6941
Epoch 27/50
 1/12 [=>............................] - ETA: 0s - loss: 0.666712/12 [==============================] - 0s 2ms/step - loss: 0.6896
Epoch 28/50
 1/12 [=>............................] - ETA: 0s - loss: 0.693112/12 [==============================] - 0s 2ms/step - loss: 0.6915
Epoch 29/50
 1/12 [=>............................] - ETA: 0s - loss: 0.689912/12 [==============================] - 0s 2ms/step - loss: 0.6911
Epoch 30/50
 1/12 [=>............................] - ETA: 0s - loss: 0.639412/12 [==============================] - 0s 2ms/step - loss: 0.6866
Epoch 31/50
 1/12 [=>............................] - ETA: 0s - loss: 0.682912/12 [==============================] - 0s 2ms/step - loss: 0.6851
Epoch 32/50
 1/12 [=>............................] - ETA: 0s - loss: 0.702412/12 [==============================] - 0s 2ms/step - loss: 0.6904
Epoch 33/50
 1/12 [=>............................] - ETA: 0s - loss: 0.721612/12 [==============================] - 0s 2ms/step - loss: 0.6883
Epoch 34/50
 1/12 [=>............................] - ETA: 0s - loss: 0.697312/12 [==============================] - 0s 2ms/step - loss: 0.6894
Epoch 35/50
 1/12 [=>............................] - ETA: 0s - loss: 0.720412/12 [==============================] - 0s 2ms/step - loss: 0.6893
Epoch 36/50
 1/12 [=>............................] - ETA: 0s - loss: 0.680712/12 [==============================] - 0s 2ms/step - loss: 0.6879
Epoch 37/50
 1/12 [=>............................] - ETA: 0s - loss: 0.671512/12 [==============================] - 0s 2ms/step - loss: 0.6901
Epoch 38/50
 1/12 [=>............................] - ETA: 0s - loss: 0.710812/12 [==============================] - 0s 2ms/step - loss: 0.6870
Epoch 39/50
 1/12 [=>............................] - ETA: 0s - loss: 0.690612/12 [==============================] - 0s 2ms/step - loss: 0.6839
Epoch 40/50
 1/12 [=>............................] - ETA: 0s - loss: 0.678712/12 [==============================] - 0s 2ms/step - loss: 0.6852
Epoch 41/50
 1/12 [=>............................] - ETA: 0s - loss: 0.654912/12 [==============================] - 0s 2ms/step - loss: 0.6836
Epoch 42/50
 1/12 [=>............................] - ETA: 0s - loss: 0.697012/12 [==============================] - 0s 2ms/step - loss: 0.6834
Epoch 43/50
 1/12 [=>............................] - ETA: 0s - loss: 0.716112/12 [==============================] - 0s 2ms/step - loss: 0.6883
Epoch 44/50
 1/12 [=>............................] - ETA: 0s - loss: 0.666712/12 [==============================] - 0s 2ms/step - loss: 0.6866
Epoch 45/50
 1/12 [=>............................] - ETA: 0s - loss: 0.688912/12 [==============================] - 0s 2ms/step - loss: 0.6850
Epoch 46/50
 1/12 [=>............................] - ETA: 0s - loss: 0.665912/12 [==============================] - 0s 2ms/step - loss: 0.6821
Epoch 47/50
 1/12 [=>............................] - ETA: 0s - loss: 0.644812/12 [==============================] - 0s 2ms/step - loss: 0.6852
Epoch 48/50
 1/12 [=>............................] - ETA: 0s - loss: 0.713812/12 [==============================] - 0s 2ms/step - loss: 0.6812
Epoch 49/50
 1/12 [=>............................] - ETA: 0s - loss: 0.687812/12 [==============================] - 0s 2ms/step - loss: 0.6811
Epoch 50/50
 1/12 [=>............................] - ETA: 0s - loss: 0.720212/12 [==============================] - 0s 2ms/step - loss: 0.6816
learning rate = 0.001
Epoch 1/50
 1/12 [=>............................] - ETA: 3s - loss: 0.740012/12 [==============================] - 0s 2ms/step - loss: 0.6786
Epoch 2/50
 1/12 [=>............................] - ETA: 0s - loss: 0.649912/12 [==============================] - 0s 2ms/step - loss: 0.6864
Epoch 3/50
 1/12 [=>............................] - ETA: 0s - loss: 0.651912/12 [==============================] - 0s 2ms/step - loss: 0.6820
Epoch 4/50
 1/12 [=>............................] - ETA: 0s - loss: 0.698712/12 [==============================] - 0s 2ms/step - loss: 0.6789
Epoch 5/50
 1/12 [=>............................] - ETA: 0s - loss: 0.660612/12 [==============================] - 0s 2ms/step - loss: 0.6800
Epoch 6/50
 1/12 [=>............................] - ETA: 0s - loss: 0.685112/12 [==============================] - 0s 2ms/step - loss: 0.6857
Epoch 7/50
 1/12 [=>............................] - ETA: 0s - loss: 0.684012/12 [==============================] - 0s 2ms/step - loss: 0.6818
Epoch 8/50
 1/12 [=>............................] - ETA: 0s - loss: 0.653312/12 [==============================] - 0s 2ms/step - loss: 0.6806
Epoch 9/50
 1/12 [=>............................] - ETA: 0s - loss: 0.636712/12 [==============================] - 0s 2ms/step - loss: 0.6800
Epoch 10/50
 1/12 [=>............................] - ETA: 0s - loss: 0.698112/12 [==============================] - 0s 2ms/step - loss: 0.6808
Epoch 11/50
 1/12 [=>............................] - ETA: 0s - loss: 0.731512/12 [==============================] - 0s 2ms/step - loss: 0.6810
Epoch 11: early stopping
The 2th layer has been pretrained.
  1/372 [..............................] - ETA: 13s 82/372 [=====>........................] - ETA: 0s 163/372 [============>.................] - ETA: 0s243/372 [==================>...........] - ETA: 0s301/372 [=======================>......] - ETA: 0s346/372 [==========================>...] - ETA: 0s372/372 [==============================] - 0s 742us/step
Copying layer-wise pretrained weights to deep autoencoders
Fine-tuning autoencoder end-to-end
learning rate = 1
Epoch 1/50
 1/12 [=>............................] - ETA: 5s - loss: 0.493212/12 [==============================] - ETA: 0s - loss: 0.715512/12 [==============================] - 1s 5ms/step - loss: 0.7155
Epoch 2/50
 1/12 [=>............................] - ETA: 0s - loss: 0.641612/12 [==============================] - ETA: 0s - loss: 0.629212/12 [==============================] - 0s 5ms/step - loss: 0.6292
Epoch 3/50
 1/12 [=>............................] - ETA: 0s - loss: 0.571812/12 [==============================] - 0s 4ms/step - loss: 0.5780
Epoch 4/50
 1/12 [=>............................] - ETA: 0s - loss: 0.572012/12 [==============================] - ETA: 0s - loss: 0.553512/12 [==============================] - 0s 5ms/step - loss: 0.5535
Epoch 5/50
 1/12 [=>............................] - ETA: 0s - loss: 0.532612/12 [==============================] - 0s 4ms/step - loss: 0.5388
Epoch 6/50
 1/12 [=>............................] - ETA: 0s - loss: 0.535612/12 [==============================] - 0s 4ms/step - loss: 0.5271
Epoch 7/50
 1/12 [=>............................] - ETA: 0s - loss: 0.521612/12 [==============================] - ETA: 0s - loss: 0.517412/12 [==============================] - 0s 5ms/step - loss: 0.5174
Epoch 8/50
 1/12 [=>............................] - ETA: 0s - loss: 0.494112/12 [==============================] - 0s 4ms/step - loss: 0.5096
Epoch 9/50
 1/12 [=>............................] - ETA: 0s - loss: 0.482512/12 [==============================] - 0s 4ms/step - loss: 0.5027
Epoch 10/50
 1/12 [=>............................] - ETA: 0s - loss: 0.504212/12 [==============================] - ETA: 0s - loss: 0.496112/12 [==============================] - 0s 5ms/step - loss: 0.4961
Epoch 11/50
 1/12 [=>............................] - ETA: 0s - loss: 0.517011/12 [==========================>...] - ETA: 0s - loss: 0.489912/12 [==============================] - 0s 5ms/step - loss: 0.4907
Epoch 12/50
 1/12 [=>............................] - ETA: 0s - loss: 0.479312/12 [==============================] - 0s 5ms/step - loss: 0.4845
Epoch 13/50
 1/12 [=>............................] - ETA: 0s - loss: 0.480012/12 [==============================] - ETA: 0s - loss: 0.478812/12 [==============================] - 0s 5ms/step - loss: 0.4788
Epoch 14/50
 1/12 [=>............................] - ETA: 0s - loss: 0.478912/12 [==============================] - 0s 4ms/step - loss: 0.4730
Epoch 15/50
 1/12 [=>............................] - ETA: 0s - loss: 0.467212/12 [==============================] - 0s 5ms/step - loss: 0.4684
Epoch 16/50
 1/12 [=>............................] - ETA: 0s - loss: 0.475312/12 [==============================] - 0s 4ms/step - loss: 0.4659
Epoch 17/50
 1/12 [=>............................] - ETA: 0s - loss: 0.454412/12 [==============================] - ETA: 0s - loss: 0.462512/12 [==============================] - 0s 5ms/step - loss: 0.4625
Epoch 18/50
 1/12 [=>............................] - ETA: 0s - loss: 0.475912/12 [==============================] - 0s 4ms/step - loss: 0.4589
Epoch 19/50
 1/12 [=>............................] - ETA: 0s - loss: 0.452911/12 [==========================>...] - ETA: 0s - loss: 0.452912/12 [==============================] - 0s 5ms/step - loss: 0.4543
Epoch 20/50
 1/12 [=>............................] - ETA: 0s - loss: 0.471811/12 [==========================>...] - ETA: 0s - loss: 0.449712/12 [==============================] - 0s 5ms/step - loss: 0.4507
Epoch 21/50
 1/12 [=>............................] - ETA: 0s - loss: 0.451912/12 [==============================] - 0s 5ms/step - loss: 0.4469
Epoch 22/50
 1/12 [=>............................] - ETA: 0s - loss: 0.450812/12 [==============================] - 0s 4ms/step - loss: 0.4432
Epoch 23/50
 1/12 [=>............................] - ETA: 0s - loss: 0.434512/12 [==============================] - 0s 5ms/step - loss: 0.4412
Epoch 24/50
 1/12 [=>............................] - ETA: 0s - loss: 0.424412/12 [==============================] - ETA: 0s - loss: 0.439312/12 [==============================] - 0s 5ms/step - loss: 0.4393
Epoch 25/50
 1/12 [=>............................] - ETA: 0s - loss: 0.438112/12 [==============================] - 0s 4ms/step - loss: 0.4367
Epoch 26/50
 1/12 [=>............................] - ETA: 0s - loss: 0.448412/12 [==============================] - 0s 4ms/step - loss: 0.4334
Epoch 27/50
 1/12 [=>............................] - ETA: 0s - loss: 0.420812/12 [==============================] - 0s 4ms/step - loss: 0.4307
Epoch 28/50
 1/12 [=>............................] - ETA: 0s - loss: 0.440112/12 [==============================] - ETA: 0s - loss: 0.429712/12 [==============================] - 0s 5ms/step - loss: 0.4297
Epoch 29/50
 1/12 [=>............................] - ETA: 0s - loss: 0.435912/12 [==============================] - ETA: 0s - loss: 0.430212/12 [==============================] - 0s 5ms/step - loss: 0.4302
Epoch 30/50
 1/12 [=>............................] - ETA: 0s - loss: 0.412112/12 [==============================] - 0s 4ms/step - loss: 0.4262
Epoch 31/50
 1/12 [=>............................] - ETA: 0s - loss: 0.431812/12 [==============================] - 0s 4ms/step - loss: 0.4226
Epoch 32/50
 1/12 [=>............................] - ETA: 0s - loss: 0.419212/12 [==============================] - ETA: 0s - loss: 0.420512/12 [==============================] - 0s 5ms/step - loss: 0.4205
Epoch 33/50
 1/12 [=>............................] - ETA: 0s - loss: 0.427112/12 [==============================] - ETA: 0s - loss: 0.418812/12 [==============================] - 0s 5ms/step - loss: 0.4188
Epoch 34/50
 1/12 [=>............................] - ETA: 0s - loss: 0.427412/12 [==============================] - ETA: 0s - loss: 0.415712/12 [==============================] - 0s 5ms/step - loss: 0.4157
Epoch 35/50
 1/12 [=>............................] - ETA: 0s - loss: 0.424312/12 [==============================] - 0s 4ms/step - loss: 0.4182
Epoch 36/50
 1/12 [=>............................] - ETA: 0s - loss: 0.423512/12 [==============================] - 0s 4ms/step - loss: 0.4160
Epoch 37/50
 1/12 [=>............................] - ETA: 0s - loss: 0.403612/12 [==============================] - 0s 4ms/step - loss: 0.4137
Epoch 38/50
 1/12 [=>............................] - ETA: 0s - loss: 0.415812/12 [==============================] - ETA: 0s - loss: 0.411212/12 [==============================] - 0s 5ms/step - loss: 0.4112
Epoch 39/50
 1/12 [=>............................] - ETA: 0s - loss: 0.406111/12 [==========================>...] - ETA: 0s - loss: 0.408612/12 [==============================] - 0s 5ms/step - loss: 0.4091
Epoch 40/50
 1/12 [=>............................] - ETA: 0s - loss: 0.405711/12 [==========================>...] - ETA: 0s - loss: 0.406712/12 [==============================] - 0s 5ms/step - loss: 0.4066
Epoch 41/50
 1/12 [=>............................] - ETA: 0s - loss: 0.402812/12 [==============================] - ETA: 0s - loss: 0.407812/12 [==============================] - 0s 5ms/step - loss: 0.4078
Epoch 42/50
 1/12 [=>............................] - ETA: 0s - loss: 0.406611/12 [==========================>...] - ETA: 0s - loss: 0.404512/12 [==============================] - 0s 5ms/step - loss: 0.4052
Epoch 43/50
 1/12 [=>............................] - ETA: 0s - loss: 0.420112/12 [==============================] - 0s 4ms/step - loss: 0.4025
Epoch 44/50
 1/12 [=>............................] - ETA: 0s - loss: 0.391512/12 [==============================] - 0s 5ms/step - loss: 0.4045
Epoch 45/50
 1/12 [=>............................] - ETA: 0s - loss: 0.406312/12 [==============================] - 0s 4ms/step - loss: 0.4025
Epoch 46/50
 1/12 [=>............................] - ETA: 0s - loss: 0.396712/12 [==============================] - 0s 4ms/step - loss: 0.4015
Epoch 47/50
 1/12 [=>............................] - ETA: 0s - loss: 0.386812/12 [==============================] - 0s 4ms/step - loss: 0.4007
Epoch 48/50
 1/12 [=>............................] - ETA: 0s - loss: 0.419412/12 [==============================] - 0s 4ms/step - loss: 0.3996
Epoch 49/50
 1/12 [=>............................] - ETA: 0s - loss: 0.401412/12 [==============================] - ETA: 0s - loss: 0.396812/12 [==============================] - 0s 5ms/step - loss: 0.3968
Epoch 50/50
 1/12 [=>............................] - ETA: 0s - loss: 0.393012/12 [==============================] - 0s 4ms/step - loss: 0.3945
learning rate = 0.1
Epoch 1/50
 1/12 [=>............................] - ETA: 5s - loss: 0.416912/12 [==============================] - 1s 4ms/step - loss: 0.3911
Epoch 2/50
 1/12 [=>............................] - ETA: 0s - loss: 0.377712/12 [==============================] - 0s 4ms/step - loss: 0.3895
Epoch 3/50
 1/12 [=>............................] - ETA: 0s - loss: 0.376112/12 [==============================] - 0s 4ms/step - loss: 0.3890
Epoch 4/50
 1/12 [=>............................] - ETA: 0s - loss: 0.397112/12 [==============================] - 0s 4ms/step - loss: 0.3886
Epoch 5/50
 1/12 [=>............................] - ETA: 0s - loss: 0.375612/12 [==============================] - 0s 5ms/step - loss: 0.3884
Epoch 6/50
 1/12 [=>............................] - ETA: 0s - loss: 0.392812/12 [==============================] - 0s 4ms/step - loss: 0.3882
Epoch 7/50
 1/12 [=>............................] - ETA: 0s - loss: 0.390012/12 [==============================] - 0s 5ms/step - loss: 0.3880
Epoch 8/50
 1/12 [=>............................] - ETA: 0s - loss: 0.373612/12 [==============================] - 0s 4ms/step - loss: 0.3879
Epoch 9/50
 1/12 [=>............................] - ETA: 0s - loss: 0.369311/12 [==========================>...] - ETA: 0s - loss: 0.388012/12 [==============================] - 0s 5ms/step - loss: 0.3877
Epoch 10/50
 1/12 [=>............................] - ETA: 0s - loss: 0.393010/12 [========================>.....] - ETA: 0s - loss: 0.384912/12 [==============================] - 0s 6ms/step - loss: 0.3875
Epoch 11/50
 1/12 [=>............................] - ETA: 0s - loss: 0.410612/12 [==============================] - ETA: 0s - loss: 0.387412/12 [==============================] - 0s 5ms/step - loss: 0.3874
Epoch 12/50
 1/12 [=>............................] - ETA: 0s - loss: 0.381112/12 [==============================] - ETA: 0s - loss: 0.387212/12 [==============================] - 0s 5ms/step - loss: 0.3872
Epoch 13/50
 1/12 [=>............................] - ETA: 0s - loss: 0.385912/12 [==============================] - 0s 4ms/step - loss: 0.3871
Epoch 14/50
 1/12 [=>............................] - ETA: 0s - loss: 0.391512/12 [==============================] - 0s 4ms/step - loss: 0.3869
Epoch 15/50
 1/12 [=>............................] - ETA: 0s - loss: 0.383512/12 [==============================] - 0s 4ms/step - loss: 0.3868
Epoch 16/50
 1/12 [=>............................] - ETA: 0s - loss: 0.395012/12 [==============================] - 0s 4ms/step - loss: 0.3867
Epoch 17/50
 1/12 [=>............................] - ETA: 0s - loss: 0.377112/12 [==============================] - 0s 4ms/step - loss: 0.3865
Epoch 18/50
 1/12 [=>............................] - ETA: 0s - loss: 0.398912/12 [==============================] - ETA: 0s - loss: 0.386412/12 [==============================] - 0s 5ms/step - loss: 0.3864
Epoch 19/50
 1/12 [=>............................] - ETA: 0s - loss: 0.385512/12 [==============================] - 0s 4ms/step - loss: 0.3863
Epoch 20/50
 1/12 [=>............................] - ETA: 0s - loss: 0.403612/12 [==============================] - ETA: 0s - loss: 0.386212/12 [==============================] - 0s 5ms/step - loss: 0.3862
Epoch 21/50
 1/12 [=>............................] - ETA: 0s - loss: 0.388912/12 [==============================] - 0s 4ms/step - loss: 0.3860
Epoch 22/50
 1/12 [=>............................] - ETA: 0s - loss: 0.392211/12 [==========================>...] - ETA: 0s - loss: 0.384912/12 [==============================] - 0s 5ms/step - loss: 0.3859
Epoch 23/50
 1/12 [=>............................] - ETA: 0s - loss: 0.379112/12 [==============================] - ETA: 0s - loss: 0.385812/12 [==============================] - 0s 5ms/step - loss: 0.3858
Epoch 24/50
 1/12 [=>............................] - ETA: 0s - loss: 0.373012/12 [==============================] - 0s 4ms/step - loss: 0.3856
Epoch 25/50
 1/12 [=>............................] - ETA: 0s - loss: 0.384712/12 [==============================] - 0s 4ms/step - loss: 0.3855
Epoch 26/50
 1/12 [=>............................] - ETA: 0s - loss: 0.397312/12 [==============================] - 0s 4ms/step - loss: 0.3854
Epoch 27/50
 1/12 [=>............................] - ETA: 0s - loss: 0.376612/12 [==============================] - 0s 4ms/step - loss: 0.3853
Epoch 28/50
 1/12 [=>............................] - ETA: 0s - loss: 0.396812/12 [==============================] - 0s 4ms/step - loss: 0.3852
Epoch 29/50
 1/12 [=>............................] - ETA: 0s - loss: 0.390212/12 [==============================] - ETA: 0s - loss: 0.385112/12 [==============================] - 0s 5ms/step - loss: 0.3851
Epoch 30/50
 1/12 [=>............................] - ETA: 0s - loss: 0.370812/12 [==============================] - ETA: 0s - loss: 0.384912/12 [==============================] - 0s 5ms/step - loss: 0.3849
Epoch 31/50
 1/12 [=>............................] - ETA: 0s - loss: 0.393612/12 [==============================] - ETA: 0s - loss: 0.384812/12 [==============================] - 0s 5ms/step - loss: 0.3848
Epoch 32/50
 1/12 [=>............................] - ETA: 0s - loss: 0.382512/12 [==============================] - ETA: 0s - loss: 0.384712/12 [==============================] - 0s 5ms/step - loss: 0.3847
Epoch 33/50
 1/12 [=>............................] - ETA: 0s - loss: 0.391011/12 [==========================>...] - ETA: 0s - loss: 0.382912/12 [==============================] - 0s 5ms/step - loss: 0.3846
Epoch 34/50
 1/12 [=>............................] - ETA: 0s - loss: 0.394112/12 [==============================] - 0s 4ms/step - loss: 0.3845
Epoch 35/50
 1/12 [=>............................] - ETA: 0s - loss: 0.392612/12 [==============================] - ETA: 0s - loss: 0.384412/12 [==============================] - 0s 5ms/step - loss: 0.3844
Epoch 36/50
 1/12 [=>............................] - ETA: 0s - loss: 0.389812/12 [==============================] - 0s 4ms/step - loss: 0.3843
Epoch 37/50
 1/12 [=>............................] - ETA: 0s - loss: 0.372412/12 [==============================] - ETA: 0s - loss: 0.384112/12 [==============================] - 0s 5ms/step - loss: 0.3841
Epoch 38/50
 1/12 [=>............................] - ETA: 0s - loss: 0.386912/12 [==============================] - 0s 4ms/step - loss: 0.3840
Epoch 39/50
 1/12 [=>............................] - ETA: 0s - loss: 0.380912/12 [==============================] - 0s 5ms/step - loss: 0.3839
Epoch 40/50
 1/12 [=>............................] - ETA: 0s - loss: 0.381512/12 [==============================] - 0s 4ms/step - loss: 0.3838
Epoch 41/50
 1/12 [=>............................] - ETA: 0s - loss: 0.382412/12 [==============================] - 0s 4ms/step - loss: 0.3837
Epoch 42/50
 1/12 [=>............................] - ETA: 0s - loss: 0.385312/12 [==============================] - 0s 4ms/step - loss: 0.3836
Epoch 43/50
 1/12 [=>............................] - ETA: 0s - loss: 0.400012/12 [==============================] - 0s 5ms/step - loss: 0.3835
Epoch 44/50
 1/12 [=>............................] - ETA: 0s - loss: 0.374411/12 [==========================>...] - ETA: 0s - loss: 0.384312/12 [==============================] - 0s 5ms/step - loss: 0.3834
Epoch 45/50
 1/12 [=>............................] - ETA: 0s - loss: 0.384512/12 [==============================] - 0s 4ms/step - loss: 0.3833
Epoch 46/50
 1/12 [=>............................] - ETA: 0s - loss: 0.377112/12 [==============================] - 0s 4ms/step - loss: 0.3832
Epoch 47/50
 1/12 [=>............................] - ETA: 0s - loss: 0.369412/12 [==============================] - 0s 4ms/step - loss: 0.3831
Epoch 48/50
 1/12 [=>............................] - ETA: 0s - loss: 0.397012/12 [==============================] - 0s 4ms/step - loss: 0.3830
Epoch 49/50
 1/12 [=>............................] - ETA: 0s - loss: 0.386112/12 [==============================] - 0s 4ms/step - loss: 0.3829
Epoch 50/50
 1/12 [=>............................] - ETA: 0s - loss: 0.381112/12 [==============================] - 0s 4ms/step - loss: 0.3828
learning rate = 0.01
Epoch 1/50
 1/12 [=>............................] - ETA: 5s - loss: 0.405512/12 [==============================] - 1s 5ms/step - loss: 0.3826
Epoch 2/50
 1/12 [=>............................] - ETA: 0s - loss: 0.371112/12 [==============================] - ETA: 0s - loss: 0.382612/12 [==============================] - 0s 5ms/step - loss: 0.3826
Epoch 3/50
 1/12 [=>............................] - ETA: 0s - loss: 0.370012/12 [==============================] - 0s 4ms/step - loss: 0.3826
Epoch 4/50
 1/12 [=>............................] - ETA: 0s - loss: 0.390812/12 [==============================] - 0s 4ms/step - loss: 0.3826
Epoch 5/50
 1/12 [=>............................] - ETA: 0s - loss: 0.369812/12 [==============================] - 0s 4ms/step - loss: 0.3826
Epoch 6/50
 1/12 [=>............................] - ETA: 0s - loss: 0.387012/12 [==============================] - 0s 4ms/step - loss: 0.3825
Epoch 7/50
 1/12 [=>............................] - ETA: 0s - loss: 0.384512/12 [==============================] - 0s 5ms/step - loss: 0.3825
Epoch 8/50
 1/12 [=>............................] - ETA: 0s - loss: 0.368612/12 [==============================] - 0s 4ms/step - loss: 0.3825
Epoch 9/50
 1/12 [=>............................] - ETA: 0s - loss: 0.364512/12 [==============================] - 0s 4ms/step - loss: 0.3825
Epoch 10/50
 1/12 [=>............................] - ETA: 0s - loss: 0.387912/12 [==============================] - 0s 4ms/step - loss: 0.3825
Epoch 11/50
 1/12 [=>............................] - ETA: 0s - loss: 0.405612/12 [==============================] - ETA: 0s - loss: 0.382512/12 [==============================] - 0s 5ms/step - loss: 0.3825
Epoch 12/50
 1/12 [=>............................] - ETA: 0s - loss: 0.376412/12 [==============================] - 0s 4ms/step - loss: 0.3825
Epoch 13/50
 1/12 [=>............................] - ETA: 0s - loss: 0.381312/12 [==============================] - ETA: 0s - loss: 0.382512/12 [==============================] - 0s 5ms/step - loss: 0.3825
Epoch 14/50
 1/12 [=>............................] - ETA: 0s - loss: 0.387112/12 [==============================] - ETA: 0s - loss: 0.382512/12 [==============================] - 0s 5ms/step - loss: 0.3825
Epoch 15/50
 1/12 [=>............................] - ETA: 0s - loss: 0.379111/12 [==========================>...] - ETA: 0s - loss: 0.381812/12 [==============================] - 0s 5ms/step - loss: 0.3824
Epoch 16/50
 1/12 [=>............................] - ETA: 0s - loss: 0.390712/12 [==============================] - 0s 4ms/step - loss: 0.3824
Epoch 17/50
 1/12 [=>............................] - ETA: 0s - loss: 0.373212/12 [==============================] - ETA: 0s - loss: 0.382412/12 [==============================] - 0s 5ms/step - loss: 0.3824
Epoch 18/50
 1/12 [=>............................] - ETA: 0s - loss: 0.394712/12 [==============================] - 0s 4ms/step - loss: 0.3824
Epoch 19/50
 1/12 [=>............................] - ETA: 0s - loss: 0.381512/12 [==============================] - 0s 4ms/step - loss: 0.3824
Epoch 20/50
 1/12 [=>............................] - ETA: 0s - loss: 0.399812/12 [==============================] - 0s 4ms/step - loss: 0.3824
Epoch 21/50
 1/12 [=>............................] - ETA: 0s - loss: 0.385112/12 [==============================] - 0s 4ms/step - loss: 0.3824
Epoch 22/50
 1/12 [=>............................] - ETA: 0s - loss: 0.388712/12 [==============================] - 0s 4ms/step - loss: 0.3824
Epoch 23/50
 1/12 [=>............................] - ETA: 0s - loss: 0.375612/12 [==============================] - 0s 4ms/step - loss: 0.3824
Epoch 24/50
 1/12 [=>............................] - ETA: 0s - loss: 0.369812/12 [==============================] - 0s 4ms/step - loss: 0.3824
Epoch 25/50
 1/12 [=>............................] - ETA: 0s - loss: 0.381612/12 [==============================] - ETA: 0s - loss: 0.382312/12 [==============================] - 0s 5ms/step - loss: 0.3823
Epoch 26/50
 1/12 [=>............................] - ETA: 0s - loss: 0.394111/12 [==========================>...] - ETA: 0s - loss: 0.381912/12 [==============================] - 0s 5ms/step - loss: 0.3823
Epoch 27/50
 1/12 [=>............................] - ETA: 0s - loss: 0.373712/12 [==============================] - ETA: 0s - loss: 0.382312/12 [==============================] - 0s 5ms/step - loss: 0.3823
Epoch 28/50
 1/12 [=>............................] - ETA: 0s - loss: 0.394012/12 [==============================] - 0s 4ms/step - loss: 0.3823
Epoch 29/50
 1/12 [=>............................] - ETA: 0s - loss: 0.387412/12 [==============================] - 0s 4ms/step - loss: 0.3823
Epoch 30/50
 1/12 [=>............................] - ETA: 0s - loss: 0.368312/12 [==============================] - 0s 5ms/step - loss: 0.3823
Epoch 31/50
 1/12 [=>............................] - ETA: 0s - loss: 0.391112/12 [==============================] - 0s 4ms/step - loss: 0.3823
Epoch 32/50
 1/12 [=>............................] - ETA: 0s - loss: 0.380011/12 [==========================>...] - ETA: 0s - loss: 0.381912/12 [==============================] - 0s 5ms/step - loss: 0.3823
Epoch 33/50
 1/12 [=>............................] - ETA: 0s - loss: 0.388612/12 [==============================] - 0s 4ms/step - loss: 0.3823
Epoch 34/50
 1/12 [=>............................] - ETA: 0s - loss: 0.391912/12 [==============================] - 0s 4ms/step - loss: 0.3823
Epoch 35/50
 1/12 [=>............................] - ETA: 0s - loss: 0.390512/12 [==============================] - 0s 4ms/step - loss: 0.3822
Epoch 36/50
 1/12 [=>............................] - ETA: 0s - loss: 0.387912/12 [==============================] - 0s 4ms/step - loss: 0.3822
Epoch 37/50
 1/12 [=>............................] - ETA: 0s - loss: 0.370512/12 [==============================] - 0s 4ms/step - loss: 0.3822
Epoch 38/50
 1/12 [=>............................] - ETA: 0s - loss: 0.385012/12 [==============================] - ETA: 0s - loss: 0.382212/12 [==============================] - 0s 5ms/step - loss: 0.3822
Epoch 39/50
 1/12 [=>............................] - ETA: 0s - loss: 0.379312/12 [==============================] - 0s 4ms/step - loss: 0.3822
Epoch 40/50
 1/12 [=>............................] - ETA: 0s - loss: 0.379912/12 [==============================] - ETA: 0s - loss: 0.382212/12 [==============================] - 0s 5ms/step - loss: 0.3822
Epoch 41/50
 1/12 [=>............................] - ETA: 0s - loss: 0.380912/12 [==============================] - ETA: 0s - loss: 0.382212/12 [==============================] - 0s 5ms/step - loss: 0.3822
Epoch 42/50
 1/12 [=>............................] - ETA: 0s - loss: 0.383912/12 [==============================] - 0s 5ms/step - loss: 0.3822
Epoch 43/50
 1/12 [=>............................] - ETA: 0s - loss: 0.398610/12 [========================>.....] - ETA: 0s - loss: 0.380112/12 [==============================] - 0s 6ms/step - loss: 0.3822
Epoch 44/50
 1/12 [=>............................] - ETA: 0s - loss: 0.373212/12 [==============================] - ETA: 0s - loss: 0.382212/12 [==============================] - 0s 5ms/step - loss: 0.3822
Epoch 45/50
 1/12 [=>............................] - ETA: 0s - loss: 0.383312/12 [==============================] - 0s 4ms/step - loss: 0.3821
Epoch 46/50
 1/12 [=>............................] - ETA: 0s - loss: 0.376112/12 [==============================] - 0s 4ms/step - loss: 0.3821
Epoch 47/50
 1/12 [=>............................] - ETA: 0s - loss: 0.368512/12 [==============================] - 0s 4ms/step - loss: 0.3821
Epoch 48/50
 1/12 [=>............................] - ETA: 0s - loss: 0.396212/12 [==============================] - ETA: 0s - loss: 0.382112/12 [==============================] - 0s 5ms/step - loss: 0.3821
Epoch 49/50
 1/12 [=>............................] - ETA: 0s - loss: 0.385412/12 [==============================] - ETA: 0s - loss: 0.382112/12 [==============================] - 0s 5ms/step - loss: 0.3821
Epoch 50/50
 1/12 [=>............................] - ETA: 0s - loss: 0.380412/12 [==============================] - 0s 4ms/step - loss: 0.3821
learning rate = 0.001
Epoch 1/50
 1/12 [=>............................] - ETA: 5s - loss: 0.404810/12 [========================>.....] - ETA: 0s - loss: 0.383512/12 [==============================] - 1s 5ms/step - loss: 0.3821
Epoch 2/50
 1/12 [=>............................] - ETA: 0s - loss: 0.370612/12 [==============================] - 0s 4ms/step - loss: 0.3821
Epoch 3/50
 1/12 [=>............................] - ETA: 0s - loss: 0.369511/12 [==========================>...] - ETA: 0s - loss: 0.381512/12 [==============================] - 0s 5ms/step - loss: 0.3821
Epoch 4/50
 1/12 [=>............................] - ETA: 0s - loss: 0.390312/12 [==============================] - ETA: 0s - loss: 0.382112/12 [==============================] - 0s 5ms/step - loss: 0.3821
Epoch 5/50
 1/12 [=>............................] - ETA: 0s - loss: 0.369412/12 [==============================] - ETA: 0s - loss: 0.382112/12 [==============================] - 0s 5ms/step - loss: 0.3821
Epoch 6/50
 1/12 [=>............................] - ETA: 0s - loss: 0.386512/12 [==============================] - ETA: 0s - loss: 0.382112/12 [==============================] - 0s 5ms/step - loss: 0.3821
Epoch 7/50
 1/12 [=>............................] - ETA: 0s - loss: 0.384011/12 [==========================>...] - ETA: 0s - loss: 0.383212/12 [==============================] - 0s 5ms/step - loss: 0.3821
Epoch 8/50
 1/12 [=>............................] - ETA: 0s - loss: 0.368112/12 [==============================] - 0s 5ms/step - loss: 0.3821
Epoch 9/50
 1/12 [=>............................] - ETA: 0s - loss: 0.364112/12 [==============================] - 0s 5ms/step - loss: 0.3821
Epoch 10/50
 1/12 [=>............................] - ETA: 0s - loss: 0.387512/12 [==============================] - 0s 4ms/step - loss: 0.3821
Epoch 11/50
 1/12 [=>............................] - ETA: 0s - loss: 0.405112/12 [==============================] - 0s 4ms/step - loss: 0.3821
Epoch 11: early stopping
learning rate = 0.0001
Epoch 1/50
 1/12 [=>............................] - ETA: 5s - loss: 0.404811/12 [==========================>...] - ETA: 0s - loss: 0.382012/12 [==============================] - 1s 5ms/step - loss: 0.3821
Epoch 2/50
 1/12 [=>............................] - ETA: 0s - loss: 0.370612/12 [==============================] - ETA: 0s - loss: 0.382112/12 [==============================] - 0s 5ms/step - loss: 0.3821
Epoch 3/50
 1/12 [=>............................] - ETA: 0s - loss: 0.369512/12 [==============================] - ETA: 0s - loss: 0.382112/12 [==============================] - 0s 5ms/step - loss: 0.3821
Epoch 4/50
 1/12 [=>............................] - ETA: 0s - loss: 0.390312/12 [==============================] - 0s 4ms/step - loss: 0.3821
Epoch 5/50
 1/12 [=>............................] - ETA: 0s - loss: 0.369412/12 [==============================] - 0s 5ms/step - loss: 0.3821
Epoch 6/50
 1/12 [=>............................] - ETA: 0s - loss: 0.386512/12 [==============================] - ETA: 0s - loss: 0.382112/12 [==============================] - 0s 5ms/step - loss: 0.3821
Epoch 7/50
 1/12 [=>............................] - ETA: 0s - loss: 0.384012/12 [==============================] - ETA: 0s - loss: 0.382112/12 [==============================] - 0s 5ms/step - loss: 0.3821
Epoch 8/50
 1/12 [=>............................] - ETA: 0s - loss: 0.368112/12 [==============================] - ETA: 0s - loss: 0.382112/12 [==============================] - 0s 5ms/step - loss: 0.3821
Epoch 9/50
 1/12 [=>............................] - ETA: 0s - loss: 0.364112/12 [==============================] - 0s 4ms/step - loss: 0.3821
Epoch 10/50
 1/12 [=>............................] - ETA: 0s - loss: 0.387512/12 [==============================] - 0s 4ms/step - loss: 0.3821
Epoch 11/50
 1/12 [=>............................] - ETA: 0s - loss: 0.405112/12 [==============================] - 0s 4ms/step - loss: 0.3821
Epoch 11: early stopping
learning rate = 1e-05
Epoch 1/50
 1/12 [=>............................] - ETA: 5s - loss: 0.404812/12 [==============================] - 1s 5ms/step - loss: 0.3821
Epoch 2/50
 1/12 [=>............................] - ETA: 0s - loss: 0.370612/12 [==============================] - 0s 4ms/step - loss: 0.3821
Epoch 3/50
 1/12 [=>............................] - ETA: 0s - loss: 0.369512/12 [==============================] - ETA: 0s - loss: 0.382112/12 [==============================] - 0s 5ms/step - loss: 0.3821
Epoch 4/50
 1/12 [=>............................] - ETA: 0s - loss: 0.390312/12 [==============================] - 0s 4ms/step - loss: 0.3821
Epoch 5/50
 1/12 [=>............................] - ETA: 0s - loss: 0.369412/12 [==============================] - ETA: 0s - loss: 0.382112/12 [==============================] - 0s 5ms/step - loss: 0.3821
Epoch 6/50
 1/12 [=>............................] - ETA: 0s - loss: 0.386512/12 [==============================] - 0s 4ms/step - loss: 0.3821
Epoch 7/50
 1/12 [=>............................] - ETA: 0s - loss: 0.384012/12 [==============================] - 0s 4ms/step - loss: 0.3821
Epoch 8/50
 1/12 [=>............................] - ETA: 0s - loss: 0.368112/12 [==============================] - 0s 4ms/step - loss: 0.3821
Epoch 9/50
 1/12 [=>............................] - ETA: 0s - loss: 0.364112/12 [==============================] - 0s 4ms/step - loss: 0.3821
Epoch 10/50
 1/12 [=>............................] - ETA: 0s - loss: 0.387512/12 [==============================] - 0s 5ms/step - loss: 0.3821
Epoch 11/50
 1/12 [=>............................] - ETA: 0s - loss: 0.405112/12 [==============================] - 0s 4ms/step - loss: 0.3821
Epoch 11: early stopping
/ictstr01/home/icb/mahima.arunkumar/hiwi/2023_Arevalo_BatchCorrection/env_store/11cd8042ea026d6b0d3805741b3d6f36_/lib/python3.11/site-packages/keras/src/engine/training.py:3079: UserWarning: You are saving your model as an HDF5 file via `model.save()`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')`.
  saving_api.save_model(
Pretraining time is 48.27104616165161
Pretrained weights are saved to /tmp/tmpvpx8pvqz /ae_weights.h5
  1/372 [..............................] - ETA: 14s 64/372 [====>.........................] - ETA: 0s 129/372 [=========>....................] - ETA: 0s194/372 [==============>...............] - ETA: 0s259/372 [===================>..........] - ETA: 0s324/372 [=========================>....] - ETA: 0s372/372 [==============================] - 0s 782us/step
...number of clusters is unknown, Initialize cluster centroid using louvain method
The value of delta_label of current 1 th iteration is 0.1856710393541877 >= tol 0.05
Epoch 1/5
 1/12 [=>............................] - ETA: 36s - loss: 0.047612/12 [==============================] - ETA: 0s - loss: 0.0419 12/12 [==============================] - 3s 7ms/step - loss: 0.0419
Epoch 2/5
 1/12 [=>............................] - ETA: 0s - loss: 0.036812/12 [==============================] - 0s 4ms/step - loss: 0.0374
Epoch 3/5
 1/12 [=>............................] - ETA: 0s - loss: 0.034712/12 [==============================] - 0s 3ms/step - loss: 0.0348
Epoch 4/5
 1/12 [=>............................] - ETA: 0s - loss: 0.034912/12 [==============================] - 0s 3ms/step - loss: 0.0329
Epoch 5/5
 1/12 [=>............................] - ETA: 0s - loss: 0.032012/12 [==============================] - 0s 3ms/step - loss: 0.0313
The value of delta_label of current 2 th iteration is 0.07055163134880592 >= tol 0.05
Epoch 1/5
 1/12 [=>............................] - ETA: 0s - loss: 0.066212/12 [==============================] - 0s 3ms/step - loss: 0.0592
Epoch 2/5
 1/12 [=>............................] - ETA: 0s - loss: 0.054412/12 [==============================] - 0s 3ms/step - loss: 0.0557
Epoch 3/5
 1/12 [=>............................] - ETA: 0s - loss: 0.052212/12 [==============================] - 0s 3ms/step - loss: 0.0526
Epoch 4/5
 1/12 [=>............................] - ETA: 0s - loss: 0.054012/12 [==============================] - 0s 3ms/step - loss: 0.0500
Epoch 5/5
 1/12 [=>............................] - ETA: 0s - loss: 0.048212/12 [==============================] - 0s 3ms/step - loss: 0.0477
The value of delta_label of current 3 th iteration is 0.056424487050117725 >= tol 0.05
Epoch 1/5
 1/12 [=>............................] - ETA: 0s - loss: 0.081712/12 [==============================] - 0s 4ms/step - loss: 0.0733
Epoch 2/5
 1/12 [=>............................] - ETA: 0s - loss: 0.067212/12 [==============================] - 0s 3ms/step - loss: 0.0692
Epoch 3/5
 1/12 [=>............................] - ETA: 0s - loss: 0.064912/12 [==============================] - 0s 3ms/step - loss: 0.0653
Epoch 4/5
 1/12 [=>............................] - ETA: 0s - loss: 0.066312/12 [==============================] - 0s 3ms/step - loss: 0.0619
Epoch 5/5
 1/12 [=>............................] - ETA: 0s - loss: 0.059612/12 [==============================] - 0s 3ms/step - loss: 0.0587
The value of delta_label of current 4 th iteration is 0.055331315169862096 >= tol 0.05
Epoch 1/5
 1/12 [=>............................] - ETA: 0s - loss: 0.098712/12 [==============================] - 0s 3ms/step - loss: 0.0885
Epoch 2/5
 1/12 [=>............................] - ETA: 0s - loss: 0.080612/12 [==============================] - 0s 3ms/step - loss: 0.0830
Epoch 3/5
 1/12 [=>............................] - ETA: 0s - loss: 0.078012/12 [==============================] - 0s 3ms/step - loss: 0.0780
Epoch 4/5
 1/12 [=>............................] - ETA: 0s - loss: 0.078912/12 [==============================] - 0s 3ms/step - loss: 0.0734
Epoch 5/5
 1/12 [=>............................] - ETA: 0s - loss: 0.070612/12 [==============================] - 0s 3ms/step - loss: 0.0691
The value of delta_label of current 5 th iteration is 0.05667675748402287 >= tol 0.05
Epoch 1/5
 1/12 [=>............................] - ETA: 0s - loss: 0.116412/12 [==============================] - 0s 3ms/step - loss: 0.1048
Epoch 2/5
 1/12 [=>............................] - ETA: 0s - loss: 0.095212/12 [==============================] - 0s 3ms/step - loss: 0.0978
Epoch 3/5
 1/12 [=>............................] - ETA: 0s - loss: 0.091912/12 [==============================] - 0s 3ms/step - loss: 0.0914
Epoch 4/5
 1/12 [=>............................] - ETA: 0s - loss: 0.091712/12 [==============================] - 0s 3ms/step - loss: 0.0857
Epoch 5/5
 1/12 [=>............................] - ETA: 0s - loss: 0.083212/12 [==============================] - 0s 3ms/step - loss: 0.0805
The value of delta_label of current 6 th iteration is 0.05541540531449714 >= tol 0.05
Epoch 1/5
 1/12 [=>............................] - ETA: 0s - loss: 0.131612/12 [==============================] - 0s 3ms/step - loss: 0.1199
Epoch 2/5
 1/12 [=>............................] - ETA: 0s - loss: 0.109512/12 [==============================] - 0s 3ms/step - loss: 0.1121
Epoch 3/5
 1/12 [=>............................] - ETA: 0s - loss: 0.106312/12 [==============================] - 0s 3ms/step - loss: 0.1054
Epoch 4/5
 1/12 [=>............................] - ETA: 0s - loss: 0.105512/12 [==============================] - 0s 4ms/step - loss: 0.0994
Epoch 5/5
 1/12 [=>............................] - ETA: 0s - loss: 0.097612/12 [==============================] - 0s 3ms/step - loss: 0.0943
The value of delta_label of current 7 th iteration is 0.05583585603767238 >= tol 0.05
Epoch 1/5
 1/12 [=>............................] - ETA: 0s - loss: 0.142312/12 [==============================] - 0s 3ms/step - loss: 0.1323
Epoch 2/5
 1/12 [=>............................] - ETA: 0s - loss: 0.122612/12 [==============================] - 0s 4ms/step - loss: 0.1253
Epoch 3/5
 1/12 [=>............................] - ETA: 0s - loss: 0.120712/12 [==============================] - 0s 3ms/step - loss: 0.1193
Epoch 4/5
 1/12 [=>............................] - ETA: 0s - loss: 0.120212/12 [==============================] - 0s 3ms/step - loss: 0.1139
Epoch 5/5
 1/12 [=>............................] - ETA: 0s - loss: 0.112912/12 [==============================] - 0s 3ms/step - loss: 0.1092
The value of delta_label of current 8 th iteration is 0.05423814328960646 >= tol 0.05
Epoch 1/5
 1/12 [=>............................] - ETA: 0s - loss: 0.151012/12 [==============================] - 0s 4ms/step - loss: 0.1428
Epoch 2/5
 1/12 [=>............................] - ETA: 0s - loss: 0.133712/12 [==============================] - 0s 3ms/step - loss: 0.1368
Epoch 3/5
 1/12 [=>............................] - ETA: 0s - loss: 0.132912/12 [==============================] - 0s 3ms/step - loss: 0.1317
Epoch 4/5
 1/12 [=>............................] - ETA: 0s - loss: 0.133112/12 [==============================] - 0s 3ms/step - loss: 0.1270
Epoch 5/5
 1/12 [=>............................] - ETA: 0s - loss: 0.126812/12 [==============================] - 0s 3ms/step - loss: 0.1229
The value of delta_label of current 9 th iteration is 0.05070635721493441 >= tol 0.05
Epoch 1/5
 1/12 [=>............................] - ETA: 0s - loss: 0.159312/12 [==============================] - 0s 3ms/step - loss: 0.1526
Epoch 2/5
 1/12 [=>............................] - ETA: 0s - loss: 0.144012/12 [==============================] - 0s 3ms/step - loss: 0.1474
Epoch 3/5
 1/12 [=>............................] - ETA: 0s - loss: 0.144012/12 [==============================] - 0s 3ms/step - loss: 0.1428
Epoch 4/5
 1/12 [=>............................] - ETA: 0s - loss: 0.144412/12 [==============================] - 0s 3ms/step - loss: 0.1386
Epoch 5/5
 1/12 [=>............................] - ETA: 0s - loss: 0.139512/12 [==============================] - 0s 3ms/step - loss: 0.1349
/ictstr01/home/icb/mahima.arunkumar/hiwi/2023_Arevalo_BatchCorrection/env_store/11cd8042ea026d6b0d3805741b3d6f36_/lib/python3.11/site-packages/keras/src/engine/training.py:3079: UserWarning: You are saving your model as an HDF5 file via `model.save()`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')`.
  saving_api.save_model(
WARNING:tensorflow:Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
delta_label  0.04978136562394887 < tol  0.05
Reached tolerance threshold. Stop training.
The final prediction cluster is:
0    1502
1    2163
2     740
3    2436
4     747
5     487
6    2201
7     403
8    1213
Name: count, dtype: int64
  1/372 [..............................] - ETA: 7s 65/372 [====>.........................] - ETA: 0s130/372 [=========>....................] - ETA: 0s195/372 [==============>...............] - ETA: 0s262/372 [====================>.........] - ETA: 0s330/372 [=========================>....] - ETA: 0s372/372 [==============================] - 0s 769us/step
The desc has been trained successfully!!!!!!
The summary of desc model is:
Model: "model_2"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 input (InputLayer)          [(None, 1014)]            0         
                                                                 
 encoder_0 (Dense)           (None, 128)               129920    
                                                                 
 encoder_1 (Dense)           (None, 32)                4128      
                                                                 
 clustering (ClusteringLaye  (None, 9)                 288       
 r)                                                              
                                                                 
=================================================================
Total params: 134336 (524.75 KB)
Trainable params: 134336 (524.75 KB)
Non-trainable params: 0 (0.00 Byte)
_________________________________________________________________
The runtime of (resolution=1.0)is: 130.48976230621338
The run time for all resolution is: 130.4951515197754
After training, the information of adata is:
 AnnData object with n_obs  n_vars = 11892  1014
    obs: 'Metadata_Source', 'Metadata_Plate', 'Metadata_Well', 'Metadata_JCP2022', 'Metadata_InChIKey', 'Metadata_InChI', 'Metadata_SMILES', 'Metadata_Batch', 'Metadata_PlateType', 'Metadata_PertType', 'Metadata_Row', 'Metadata_Column', 'Metadata_Microscope', 'desc_1.0'
    uns: 'prob_matrix1.0'
    obsm: 'X_Embeded_z1.0'
